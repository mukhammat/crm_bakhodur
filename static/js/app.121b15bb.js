(function(){"use strict";var e={7861:function(e,t,a){var l=a(5130),n=a(6768),r=a(144),s=a(1387),o={__name:"AppHeader",setup(e){return(e,t)=>{const a=(0,n.g2)("v-toolbar-title"),l=(0,n.g2)("v-spacer"),r=(0,n.g2)("v-btn"),s=(0,n.g2)("v-icon"),o=(0,n.g2)("v-app-bar");return(0,n.uX)(),(0,n.Wv)(o,{app:"",color:"primary",dark:""},{default:(0,n.k6)(()=>[(0,n.bF)(a,null,{default:(0,n.k6)(()=>[...t[0]||(t[0]=[(0,n.eW)("🚀 MyApp",-1)])]),_:1}),(0,n.bF)(l),(0,n.bF)(r,{text:""},{default:(0,n.k6)(()=>[...t[1]||(t[1]=[(0,n.eW)("Главная",-1)])]),_:1}),(0,n.bF)(r,{text:""},{default:(0,n.k6)(()=>[...t[2]||(t[2]=[(0,n.eW)("Задачи",-1)])]),_:1}),(0,n.bF)(r,{text:""},{default:(0,n.k6)(()=>[...t[3]||(t[3]=[(0,n.eW)("О нас",-1)])]),_:1}),(0,n.bF)(r,{icon:""},{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...t[4]||(t[4]=[(0,n.eW)("mdi-account-circle",-1)])]),_:1})]),_:1})]),_:1})}}},u=a(1241);const i=(0,u.A)(o,[["__scopeId","data-v-4594a976"]]);var d=i,c={__name:"App",setup(e){const t=(0,s.lq)();return(e,a)=>{const l=(0,n.g2)("router-view"),s=(0,n.g2)("v-main"),o=(0,n.g2)("v-app");return(0,n.uX)(),(0,n.Wv)(o,null,{default:(0,n.k6)(()=>[(0,r.R1)(t).meta.hideHeader?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(d,{key:0})),(0,n.bF)(s,null,{default:(0,n.k6)(()=>[(0,n.bF)(l)]),_:1})]),_:1})}}};const v=c;var m=v,k=a(4232),f={__name:"DashboardPage",setup(e){const t={completed:120,inProgress:15,pending:40,points:5800},a=[{title:"Имя",key:"name"},{title:"Выполнено задач",key:"tasksCompleted"},{title:"Баллы",key:"points"}],l=[{name:"Иван",tasksCompleted:50,points:1200},{name:"Анна",tasksCompleted:45,points:1100},{name:"Олег",tasksCompleted:30,points:700}];return(e,r)=>{const s=(0,n.g2)("v-card-title"),o=(0,n.g2)("v-card-text"),u=(0,n.g2)("v-card"),i=(0,n.g2)("v-col"),d=(0,n.g2)("v-row"),c=(0,n.g2)("v-data-table"),v=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(v,null,{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(i,{cols:"12",md:"3"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[0]||(r[0]=[(0,n.eW)("Выполнено задач",-1)])]),_:1}),(0,n.bF)(o,{class:"text-h4"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(t.completed),1)]),_:1})]),_:1})]),_:1}),(0,n.bF)(i,{cols:"12",md:"3"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[1]||(r[1]=[(0,n.eW)("В процессе",-1)])]),_:1}),(0,n.bF)(o,{class:"text-h4"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(t.inProgress),1)]),_:1})]),_:1})]),_:1}),(0,n.bF)(i,{cols:"12",md:"3"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[2]||(r[2]=[(0,n.eW)("Ожидают",-1)])]),_:1}),(0,n.bF)(o,{class:"text-h4"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(t.pending),1)]),_:1})]),_:1})]),_:1}),(0,n.bF)(i,{cols:"12",md:"3"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[3]||(r[3]=[(0,n.eW)("Сумма баллов",-1)])]),_:1}),(0,n.bF)(o,{class:"text-h4"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(t.points),1)]),_:1})]),_:1})]),_:1})]),_:1}),(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(i,{cols:"12",md:"6"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[4]||(r[4]=[(0,n.eW)("Задачи по статусу",-1)])]),_:1}),(0,n.bF)(o,null,{default:(0,n.k6)(()=>[...r[5]||(r[5]=[(0,n.Lk)("div",{class:"text-center"},"[Диаграмма]",-1)])]),_:1})]),_:1})]),_:1}),(0,n.bF)(i,{cols:"12",md:"6"},{default:(0,n.k6)(()=>[(0,n.bF)(u,null,{default:(0,n.k6)(()=>[(0,n.bF)(s,null,{default:(0,n.k6)(()=>[...r[6]||(r[6]=[(0,n.eW)("Топ сотрудников",-1)])]),_:1}),(0,n.bF)(c,{headers:a,items:l})]),_:1})]),_:1})]),_:1})]),_:1})}}};const p=f;var g=p,b=a(1114);a(4603),a(7566),a(8721);class h{static async request(e,t){return(new h).request(e,t)}async request(e,t){const a="Content-Type",l={};let n=t.body;if(t.bodyType)switch(t.bodyType){case"HTML":l[a]="text/html";break;case"JS":l[a]="application/javascript";break;case"JSON":l[a]="application/json",n=JSON.stringify(t.body);break;case"Text":l[a]="application/plain";break;case"XML":l[a]="application/xml";break;default:l[a]=t.bodyType;break}else"object"===typeof t.body&&(l["Content-Type"]="application/json",n=JSON.stringify(t.body));try{const a=await fetch(e,{method:t.method,headers:{...l,...t.headers},body:n});if(!a.ok)throw new Error(a?.message||`Ошибка ${a.status}`);return a}catch(r){throw console.log(r?.message),r}}}var _=a(2261);const y="http://localhost:3000",F=(0,_.nY)("auth",{state:()=>({user:null,token:localStorage.getItem("token")||null}),getters:{role:e=>e.user?.role||null,isAuthenticated:e=>!!e.token},actions:{async login({email:e,password:t}){try{const a=await fetch(`${y}/api/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!a.ok){const e=await a.json();throw new Error(e.message||"Неверный логин или пароль")}const{data:l}=await a.json();this.token=l.token,localStorage.setItem("token",this.token),await this.fetchMe()}catch(a){throw this.logout(),a}},async register(e){try{const t=await fetch(`${y}/api/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const e=await t.json();throw new Error(e.message||"Ошибка при регистрации")}const a=await t.json();return console.log("Registration successful:",a),await this.login({email:e.email,password:e.password}),a.data?.userId}catch(t){throw this.logout(),t}},async fetchMe(){if(this.token)try{const e=await fetch(`${y}/api/users/me`,{headers:{Authorization:`Bearer ${this.token}`}});if(!e.ok){if(401===e.status)throw this.logout(),new Error("Сессия истекла");throw new Error("Не удалось загрузить профиль")}const{data:t}=await e.json();this.user=t}catch(e){throw e.message.includes("Сессия истекла")&&this.logout(),e}},logout(){this.user=null,this.token=null,localStorage.removeItem("token")},async init(){if(this.token)try{await this.fetchMe()}catch(e){console.warn("Failed to restore user session:",e.message)}}}});class w{constructor(){(0,b.A)(this,"SERVER","http://localhost:3000")}get headers(){return this.auth=F(),{Authorization:this.auth.token?`Bearer ${this.auth.token}`:""}}async add(e){return h.request(`${this.SERVER}/api/tasks`,{method:"POST",headers:this.headers,body:e})}async removeAssignment(e){return h.request(`${this.SERVER}/api/tasks/unassign-task-from-worker/${e}`,{method:"DELETE",headers:this.headers})}async edit(e,t){return h.request(`${this.SERVER}/api/tasks/${e}`,{method:"PUT",headers:this.headers,body:t})}async delete(e){return h.request(`${this.SERVER}/api/tasks/${e}`,{method:"DELETE",headers:this.headers})}async assignUser(e){return h.request(`${this.SERVER}/api/tasks/assign-task-worker`,{method:"POST",headers:this.headers,body:e})}async getAll(e={}){const t=new URLSearchParams(e).toString();return h.request(`${this.SERVER}/api/tasks${t?`?${t}`:""}`,{headers:this.headers})}}const W=new w;var V={__name:"TaskForm",props:{getTasks:Function},setup(e){const t=(0,r.KR)({title:"",description:""}),a=e,l=a.getTasks,s=(0,r.KR)(!1),o=(0,r.KR)(!1);async function u(){if(t.value.title&&t.value.description)try{o.value=!0;const e=await W.add(t.value);e.ok&&(i(),await l())}finally{o.value=!1}}function i(){s.value=!1,t.value={title:"",description:""}}return(e,a)=>{const d=(0,n.g2)("v-btn"),c=(0,n.g2)("v-card-title"),v=(0,n.g2)("v-row"),m=(0,n.g2)("v-text-field"),k=(0,n.g2)("v-card-text"),f=(0,n.g2)("v-spacer"),p=(0,n.g2)("v-card-actions"),g=(0,n.g2)("v-card"),b=(0,n.g2)("v-dialog"),h=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(h,null,{default:(0,n.k6)(()=>[(0,n.bF)(v,{justify:"center"},{default:(0,n.k6)(()=>[(0,n.bF)(c,null,{default:(0,n.k6)(()=>[(0,n.bF)(d,{color:"primary",onClick:(0,r.R1)(l),class:"mr-2"},{default:(0,n.k6)(()=>[...a[4]||(a[4]=[(0,n.eW)("Обновить",-1)])]),_:1},8,["onClick"]),(0,n.bF)(d,{color:"success",onClick:a[0]||(a[0]=e=>s.value=!0)},{default:(0,n.k6)(()=>[...a[5]||(a[5]=[(0,n.eW)("Добавить задачу",-1)])]),_:1})]),_:1})]),_:1}),(0,n.bF)(b,{modelValue:s.value,"onUpdate:modelValue":a[3]||(a[3]=e=>s.value=e),"max-width":"500px"},{default:(0,n.k6)(()=>[(0,n.bF)(g,null,{default:(0,n.k6)(()=>[(0,n.bF)(c,null,{default:(0,n.k6)(()=>[...a[6]||(a[6]=[(0,n.eW)("Добавить задачу",-1)])]),_:1}),(0,n.bF)(k,null,{default:(0,n.k6)(()=>[(0,n.bF)(m,{modelValue:t.value.title,"onUpdate:modelValue":a[1]||(a[1]=e=>t.value.title=e),label:"Название",required:""},null,8,["modelValue"]),(0,n.bF)(m,{modelValue:t.value.description,"onUpdate:modelValue":a[2]||(a[2]=e=>t.value.description=e),label:"Описание",required:""},null,8,["modelValue"])]),_:1}),(0,n.bF)(p,null,{default:(0,n.k6)(()=>[(0,n.bF)(f),(0,n.bF)(d,{text:"",onClick:i},{default:(0,n.k6)(()=>[...a[7]||(a[7]=[(0,n.eW)("Отмена",-1)])]),_:1}),(0,n.bF)(d,{color:"success",onClick:u,loading:o.value},{default:(0,n.k6)(()=>[...a[8]||(a[8]=[(0,n.eW)(" Сохранить ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}};const E=V;var x=E;a(4114),a(8111),a(2489),a(1701);function R(){const e=F(),t=(0,n.EW)(()=>e.role),a=(0,n.EW)(()=>"admin"===t.value),l=(0,n.EW)(()=>"manager"===t.value),r=(0,n.EW)(()=>"worker"===t.value),s=e=>t.value===e,o=e=>e.includes(t.value),u=(0,n.EW)(()=>o(["admin","manager"])),i=(0,n.EW)(()=>o(["admin","manager"])),d=(0,n.EW)(()=>o(["admin","manager"])),c=(0,n.EW)(()=>"worker"===t.value);return{userRole:t,isAdmin:a,isManager:l,isWorker:r,hasRole:s,hasAnyRole:o,canManageUsers:u,canCreateTasks:i,canViewAllTasks:d,canOnlyViewOwnTasks:c}}class C{constructor(){(0,b.A)(this,"SERVER","http://localhost:3000")}get headers(){return this.auth=F(),{Authorization:this.auth.token?`Bearer ${this.auth.token}`:""}}async me(){return h.request(`${this.SERVER}/api/user/me`,{method:"GET",headers:this.headers})}async getAll(){return h.request(`${this.SERVER}/api/users`,{method:"GET",headers:this.headers})}async delete(e){return h.request(`${this.SERVER}/api/users/${e}`,{method:"DELETE",headers:this.headers})}async generateKey(e){return h.request(`${this.SERVER}/api/users/register-key/${e}`,{method:"GET",headers:this.headers})}}const K=new C,T={class:"text-truncate",style:{"max-width":"200px"}},A={class:"d-flex align-center"},$={key:1,class:"text-grey text-caption align-self-center ml-2"};var S={__name:"TaskList",props:{tasks:Array,getTasks:Function},setup(e){const{isAdmin:t}=R(),a=F(),s=(0,n.EW)(()=>e=>t.value||e.createdBy?.id===a.user?.id),o=(0,n.EW)(()=>e=>t.value||e.createdBy?.id===a.user?.id),u=[{label:"Ожидает",value:"pending"},{label:"В процессе",value:"in_progress"},{label:"Завершено",value:"completed"}],i=e,d=(0,r.lW)(i,"tasks"),c=i.getTasks,v=(0,r.KR)([]),m=(0,r.KR)(!1),f=(0,r.KR)([]),p=(0,r.KR)(!1),g=(0,r.KR)(!1),b=(0,r.KR)(!1),h=(0,r.KR)(null),_=(0,r.KR)(null),y=(0,r.KR)(!1),w=(0,r.KR)(!1),V=(0,r.KR)(!1),E=(0,r.KR)(""),x=(0,r.KR)(""),C=e=>{E.value=e,w.value=!0},S=e=>{x.value=e,V.value=!0};async function j(){try{y.value=!0;const e=await K.getAll(),t=await e.json();v.value=t.data.users}catch(e){console.error("Error fetching users:",e),S("Ошибка загрузки пользователей")}finally{y.value=!1}}(0,n.sV)(j);const q=[{title:"Название",key:"title"},{title:"Описание",key:"description"},{title:"Статус",key:"status"},{title:"Создатель",key:"createdBy.name"},{title:"Исполнители",key:"assignments.worker"},{title:"Действия",key:"actions",sortable:!1}];function U(e,{item:t}){X(t)}function X(e){h.value={...e,workerIds:e.assignments?.map(e=>e.userId)||[]},p.value=!0}function L(){p.value=!1,h.value=null}function O(e){_.value=e,g.value=!0}function z(e){h.value.workerIds=h.value.workerIds.filter(t=>t!==e)}async function I(e,t){for(const a of t){const e=await W.removeAssignment(a.id);if(!e.ok)throw new Error(`Ошибка при удалении назначения ${a.id}`)}}async function P(){if(h.value.title&&h.value.description&&h.value.status)try{b.value=!0;const e=await W.edit(h.value.id,{title:h.value.title,description:h.value.description,status:h.value.status});if(!e.ok)throw new Error("Ошибка при обновлении задачи");h.value.assignments?.length>0&&await I(h.value.id,h.value.assignments);for(const t of h.value.workerIds){const e=await W.assignUser({taskId:h.value.id,userId:t});if(!e.ok)throw new Error("Ошибка назначения пользователя")}await c(),L(),C("Задача успешно обновлена")}catch(e){console.error("Error saving task:",e),S(e.message||"Ошибка при сохранении задачи")}finally{b.value=!1}else S("Пожалуйста, заполните все обязательные поля")}async function Q(){if(_.value)try{f.value.push(_.value.id);const e=await W.delete(_.value.id);if(!e.ok)throw new Error("Ошибка при удалении задачи");await c(),C("Задача успешно удалена")}catch(e){console.error("Error deleting task:",e),S(e.message||"Ошибка при удалении задачи")}finally{f.value=f.value.filter(e=>e!==_.value.id),g.value=!1,_.value=null}}function M(e){switch(e){case"admin":return"red";case"manager":return"blue";case"worker":return"green";default:return"grey"}}function B(e){switch(e){case"completed":return"green";case"in_progress":return"blue";case"pending":return"orange";default:return"grey"}}function N(e){switch(e){case"completed":return"Завершено";case"in_progress":return"В процессе";case"pending":return"Ожидает";default:return e}}return(e,i)=>{const c=(0,n.g2)("v-badge"),F=(0,n.g2)("v-btn"),W=(0,n.g2)("v-icon"),R=(0,n.g2)("v-avatar"),C=(0,n.g2)("v-list-item-title"),K=(0,n.g2)("v-chip"),S=(0,n.g2)("v-list-item"),j=(0,n.g2)("v-list"),X=(0,n.g2)("v-menu"),I=(0,n.g2)("v-data-table"),D=(0,n.g2)("v-card"),G=(0,n.g2)("v-col"),H=(0,n.g2)("v-row"),J=(0,n.g2)("v-card-title"),Y=(0,n.g2)("v-card-text"),Z=(0,n.g2)("v-spacer"),ee=(0,n.g2)("v-card-actions"),te=(0,n.g2)("v-dialog"),ae=(0,n.g2)("v-text-field"),le=(0,n.g2)("v-textarea"),ne=(0,n.g2)("v-select"),re=(0,n.g2)("v-alert"),se=(0,n.g2)("v-container"),oe=(0,n.g2)("v-snackbar");return(0,n.uX)(),(0,n.Wv)(se,null,{default:(0,n.k6)(()=>[(0,n.bF)(H,{justify:"center"},{default:(0,n.k6)(()=>[(0,n.bF)(G,{cols:"12",md:"10"},{default:(0,n.k6)(()=>[(0,n.bF)(D,null,{default:(0,n.k6)(()=>[(0,n.bF)(I,{headers:q,items:d.value,"item-key":"id",class:"elevation-1",loading:m.value,"onClick:row":U,hover:""},{"item.title":(0,n.k6)(({item:e})=>[(0,n.eW)((0,k.v_)(e.title),1)]),"item.description":(0,n.k6)(({item:e})=>[(0,n.Lk)("div",T,(0,k.v_)(e.description),1)]),"item.assignments.worker":(0,n.k6)(({item:e})=>[e.assignments&&e.assignments.length>0?((0,n.uX)(),(0,n.Wv)(X,{key:0,onClick:i[0]||(i[0]=(0,l.D$)(()=>{},["stop"]))},{activator:(0,n.k6)(({props:t})=>[(0,n.bF)(F,(0,n.v6)(t,{color:"green",size:"small",variant:"tonal"}),{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(e.assignments[0]?.user?.name||"Без имени")+" ",1),e.assignments.length>1?((0,n.uX)(),(0,n.Wv)(c,{key:0,content:e.assignments.length,color:"primary",inline:""},null,8,["content"])):(0,n.Q3)("",!0)]),_:2},1040)]),default:(0,n.k6)(()=>[(0,n.bF)(j,{density:"compact"},{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.assignments,e=>((0,n.uX)(),(0,n.Wv)(S,{key:e.id},{prepend:(0,n.k6)(()=>[(0,n.bF)(R,{size:"24",color:M(e.user?.role)},{default:(0,n.k6)(()=>[(0,n.bF)(W,{size:"16"},{default:(0,n.k6)(()=>[...i[11]||(i[11]=[(0,n.eW)("mdi-account",-1)])]),_:1})]),_:1},8,["color"])]),append:(0,n.k6)(()=>[(0,n.bF)(K,{size:"x-small",color:M(e.user?.role)},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(e.user?.role),1)]),_:2},1032,["color"])]),default:(0,n.k6)(()=>[(0,n.bF)(C,{class:"text-body-2"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(e.user?.name||"Без имени"),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)):((0,n.uX)(),(0,n.Wv)(K,{key:1,color:"grey",variant:"outlined",size:"small"},{default:(0,n.k6)(()=>[...i[12]||(i[12]=[(0,n.eW)(" Не назначен ",-1)])]),_:1}))]),"item.status":(0,n.k6)(({item:e})=>[(0,n.bF)(K,{color:B(e?.status),variant:"flat",size:"small"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(N(e?.status)),1)]),_:2},1032,["color"])]),"item.createdBy.name":(0,n.k6)(({item:e})=>[(0,n.Lk)("div",A,[(0,n.bF)(R,{size:"24",color:M(e.createdBy?.role),class:"mr-2"},{default:(0,n.k6)(()=>[(0,n.bF)(W,{size:"16"},{default:(0,n.k6)(()=>[...i[13]||(i[13]=[(0,n.eW)("mdi-account",-1)])]),_:1})]),_:1},8,["color"]),(0,n.Lk)("span",null,(0,k.v_)(e.createdBy?.name||"Неизвестно"),1),e.createdBy?.id===(0,r.R1)(a).user?.id?((0,n.uX)(),(0,n.Wv)(K,{key:0,color:"primary",size:"x-small",class:"ml-2"},{default:(0,n.k6)(()=>[...i[14]||(i[14]=[(0,n.eW)(" Ваша ",-1)])]),_:1})):(0,n.Q3)("",!0)])]),"item.actions":(0,n.k6)(({item:e})=>[(0,n.Lk)("div",{class:"d-flex ga-2",onClick:i[1]||(i[1]=(0,l.D$)(()=>{},["stop"]))},[o.value(e)?((0,n.uX)(),(0,n.Wv)(F,{key:0,color:"error",size:"small",variant:"outlined",onClick:t=>O(e),loading:f.value.includes(e.id),disabled:m.value},{default:(0,n.k6)(()=>[...i[15]||(i[15]=[(0,n.eW)(" Удалить ",-1)])]),_:1},8,["onClick","loading","disabled"])):(0,n.Q3)("",!0),s.value(e)||o.value(e)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(K,{key:1,color:"grey",variant:"outlined",size:"small"},{default:(0,n.k6)(()=>[...i[16]||(i[16]=[(0,n.eW)(" Только просмотр ",-1)])]),_:1}))])]),_:1},8,["items","loading"])]),_:1})]),_:1})]),_:1}),(0,n.bF)(te,{modelValue:g.value,"onUpdate:modelValue":i[3]||(i[3]=e=>g.value=e),"max-width":"400px"},{default:(0,n.k6)(()=>[(0,n.bF)(D,null,{default:(0,n.k6)(()=>[(0,n.bF)(J,{class:"text-h6"},{default:(0,n.k6)(()=>[...i[17]||(i[17]=[(0,n.eW)(" Подтвердите удаление ",-1)])]),_:1}),(0,n.bF)(Y,null,{default:(0,n.k6)(()=>[(0,n.eW)(' Вы уверены, что хотите удалить задачу "'+(0,k.v_)(_.value?.title)+'"? Это действие нельзя отменить. ',1)]),_:1}),(0,n.bF)(ee,null,{default:(0,n.k6)(()=>[(0,n.bF)(Z),(0,n.bF)(F,{variant:"text",onClick:i[2]||(i[2]=e=>g.value=!1)},{default:(0,n.k6)(()=>[...i[18]||(i[18]=[(0,n.eW)(" Отмена ",-1)])]),_:1}),(0,n.bF)(F,{color:"error",onClick:Q,loading:f.value.includes(_.value?.id)},{default:(0,n.k6)(()=>[...i[19]||(i[19]=[(0,n.eW)(" Удалить ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),(0,n.bF)(te,{modelValue:p.value,"onUpdate:modelValue":i[8]||(i[8]=e=>p.value=e),"max-width":"700px"},{default:(0,n.k6)(()=>[h.value?((0,n.uX)(),(0,n.Wv)(D,{key:0},{default:(0,n.k6)(()=>[(0,n.bF)(J,null,{default:(0,n.k6)(()=>[i[21]||(i[21]=(0,n.Lk)("span",{class:"text-h6"},"Редактировать задачу",-1)),h.value?.createdBy?.id!==(0,r.R1)(a).user?.id||(0,r.R1)(t)?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(K,{key:0,color:"primary",size:"small",class:"ml-3"},{default:(0,n.k6)(()=>[...i[20]||(i[20]=[(0,n.eW)(" Ваша задача ",-1)])]),_:1}))]),_:1}),(0,n.bF)(Y,null,{default:(0,n.k6)(()=>[(0,n.bF)(se,null,{default:(0,n.k6)(()=>[(0,n.bF)(H,null,{default:(0,n.k6)(()=>[(0,n.bF)(G,{cols:"12"},{default:(0,n.k6)(()=>[(0,n.bF)(ae,{modelValue:h.value.title,"onUpdate:modelValue":i[4]||(i[4]=e=>h.value.title=e),label:"Название задачи",required:"",rules:[e=>!!e||"Название обязательно"],variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),(0,n.bF)(G,{cols:"12"},{default:(0,n.k6)(()=>[(0,n.bF)(le,{modelValue:h.value.description,"onUpdate:modelValue":i[5]||(i[5]=e=>h.value.description=e),label:"Описание задачи",required:"",rules:[e=>!!e||"Описание обязательно"],rows:"3",variant:"outlined"},null,8,["modelValue","rules"])]),_:1}),(0,n.bF)(G,{cols:"12",md:"6"},{default:(0,n.k6)(()=>[(0,n.bF)(ne,{modelValue:h.value.status,"onUpdate:modelValue":i[6]||(i[6]=e=>h.value.status=e),items:u,"item-title":"label","item-value":"value",label:"Статус задачи",variant:"outlined"},null,8,["modelValue"])]),_:1}),(0,n.bF)(G,{cols:"12",md:"6"},{default:(0,n.k6)(()=>[(0,n.bF)(K,{color:B(h.value.status),class:"mt-4"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(N(h.value.status)),1)]),_:1},8,["color"])]),_:1}),(0,n.bF)(G,{cols:"12"},{default:(0,n.k6)(()=>[(0,n.bF)(ne,{modelValue:h.value.workerIds,"onUpdate:modelValue":i[7]||(i[7]=e=>h.value.workerIds=e),items:v.value,"item-title":"name","item-value":"id",label:"Назначить пользователей",multiple:"",chips:"","closable-chips":"",loading:y.value,variant:"outlined"},{selection:(0,n.k6)(({item:e,index:t})=>[t<3?((0,n.uX)(),(0,n.Wv)(K,{key:0,size:"small",closable:"",color:M(e.raw.role),variant:"tonal","onClick:close":t=>z(e.raw.id)},{default:(0,n.k6)(()=>[(0,n.bF)(W,{start:"",size:"16"},{default:(0,n.k6)(()=>[...i[22]||(i[22]=[(0,n.eW)("mdi-account",-1)])]),_:1}),(0,n.eW)(" "+(0,k.v_)(e.title),1)]),_:2},1032,["color","onClick:close"])):(0,n.Q3)("",!0),3===t?((0,n.uX)(),(0,n.CE)("span",$," (+"+(0,k.v_)(h.value.workerIds.length-3)+" других) ",1)):(0,n.Q3)("",!0)]),item:(0,n.k6)(({props:e,item:t})=>[(0,n.bF)(S,(0,n.v6)(e,{title:t.title}),{prepend:(0,n.k6)(()=>[(0,n.bF)(R,{size:"32",color:M(t.raw.role)},{default:(0,n.k6)(()=>[(0,n.bF)(W,null,{default:(0,n.k6)(()=>[...i[23]||(i[23]=[(0,n.eW)("mdi-account",-1)])]),_:1})]),_:1},8,["color"])]),append:(0,n.k6)(()=>[(0,n.bF)(K,{size:"x-small",color:M(t.raw.role)},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(t.raw.role),1)]),_:2},1032,["color"]),h.value.workerIds.includes(t.value)?((0,n.uX)(),(0,n.Wv)(W,{key:0,color:"success",class:"ml-2"},{default:(0,n.k6)(()=>[...i[24]||(i[24]=[(0,n.eW)(" mdi-check ",-1)])]),_:1})):(0,n.Q3)("",!0)]),_:2},1040,["title"])]),"no-data":(0,n.k6)(()=>[(0,n.bF)(S,null,{default:(0,n.k6)(()=>[(0,n.bF)(C,null,{default:(0,n.k6)(()=>[...i[25]||(i[25]=[(0,n.eW)("Пользователи не найдены",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue","items","loading"])]),_:1}),0===h.value.workerIds.length?((0,n.uX)(),(0,n.Wv)(G,{key:0,cols:"12"},{default:(0,n.k6)(()=>[(0,n.bF)(re,{type:"warning",variant:"tonal",density:"compact"},{default:(0,n.k6)(()=>[...i[26]||(i[26]=[(0,n.eW)(" Задача не назначена ни одному пользователю ",-1)])]),_:1})]),_:1})):(0,n.Q3)("",!0)]),_:1})]),_:1})]),_:1}),(0,n.bF)(ee,null,{default:(0,n.k6)(()=>[(0,n.bF)(Z),(0,n.bF)(F,{variant:"text",onClick:L},{default:(0,n.k6)(()=>[...i[27]||(i[27]=[(0,n.eW)(" Отмена ",-1)])]),_:1}),(0,n.bF)(F,{color:"success",onClick:P,loading:b.value,disabled:!h.value.title||!h.value.description},{default:(0,n.k6)(()=>[...i[28]||(i[28]=[(0,n.eW)(" Сохранить изменения ",-1)])]),_:1},8,["loading","disabled"])]),_:1})]),_:1})):(0,n.Q3)("",!0)]),_:1},8,["modelValue"]),(0,n.bF)(oe,{modelValue:w.value,"onUpdate:modelValue":i[9]||(i[9]=e=>w.value=e),color:"success",timeout:"3000"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(E.value),1)]),_:1},8,["modelValue"]),(0,n.bF)(oe,{modelValue:V.value,"onUpdate:modelValue":i[10]||(i[10]=e=>V.value=e),color:"error",timeout:"5000"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(x.value),1)]),_:1},8,["modelValue"])]),_:1})}}};const j=S;var q=j,U={__name:"TaskManager",setup(e){const t=(0,r.KR)([]),a=(0,r.KR)(null),l=[{label:"Ожидает",value:"pending"},{label:"В процессе",value:"in_progress"},{label:"Завершено",value:"completed"},{label:"Все",value:null}];async function s(){try{const e={};a.value&&(e.status=a.value);const l=await W.getAll(e),n=await l.json();t.value=n.data.tasks,console.log(n.data.tasks)}catch(e){console.error("Error fetching tasks:",e)}}return(0,n.sV)(s),(0,n.wB)(a,()=>{s()}),(e,r)=>{const o=(0,n.g2)("v-select"),u=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(u,{md:"5"},{default:(0,n.k6)(()=>[(0,n.bF)(o,{modelValue:a.value,"onUpdate:modelValue":r[0]||(r[0]=e=>a.value=e),items:l,"item-title":"label","item-value":"value",label:"Фильтр по статусу",class:"mb-1",chips:"","closable-chips":""},null,8,["modelValue"])]),_:1}),(0,n.bF)(x,{getTasks:s}),(0,n.bF)(q,{getTasks:s,tasks:t.value},null,8,["tasks"])],64)}}};const X=U;var L=X,O={__name:"UserList",props:{users:Array,getUsers:Function},setup(e){const t=e,a=(0,r.lW)(t,"users"),l=t.getUsers,s=(0,r.KR)([]),o=[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Роль",key:"role"},{title:"Активный",key:"isActive"},{title:"Действия",key:"actions",sortable:!1}];async function u(e){try{s.value.push(e);const t=await K.delete(e);t.ok&&(await l(),a.value=a.value.filter(t=>t.id!==e))}finally{s.value=s.value.filter(t=>t!==e)}}return(e,t)=>{const l=(0,n.g2)("v-chip"),r=(0,n.g2)("v-btn"),i=(0,n.g2)("v-data-table"),d=(0,n.g2)("v-card"),c=(0,n.g2)("v-col"),v=(0,n.g2)("v-row"),m=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(m,null,{default:(0,n.k6)(()=>[(0,n.bF)(v,{justify:"center"},{default:(0,n.k6)(()=>[(0,n.bF)(c,{cols:"14",md:"10"},{default:(0,n.k6)(()=>[(0,n.bF)(d,null,{default:(0,n.k6)(()=>[(0,n.bF)(i,{headers:o,items:a.value,"item-key":"id",class:"elevation-1"},{"item.title":(0,n.k6)(({item:e})=>[(0,n.eW)((0,k.v_)(e.name),1)]),"item.description":(0,n.k6)(({item:e})=>[(0,n.eW)((0,k.v_)(e.description),1)]),"item.status":(0,n.k6)(({item:e})=>[(0,n.bF)(l,{color:"completed"===e?.status?"green":"orange",variant:"flat"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(e?.status),1)]),_:2},1032,["color"])]),"item.actions":(0,n.k6)(({item:e})=>[(0,n.bF)(r,{color:"red",size:"small",onClick:t=>u(e.id),loading:s.value.includes(e.id)},{default:(0,n.k6)(()=>[...t[0]||(t[0]=[(0,n.eW)(" Удалить ",-1)])]),_:1},8,["onClick","loading"])]),_:1},8,["items"])]),_:1})]),_:1})]),_:1})]),_:1})}}};const z=O;var I=z;const P={class:"d-flex align-center"},Q={class:"mb-3"},M={class:"d-flex gap-2"};var B={__name:"GenerateKey",setup(e){const t=(0,r.KR)(""),a=(0,r.KR)(""),l=(0,r.KR)(!1),s=(0,r.KR)(!1),o=(0,r.KR)(""),u=[{title:"Менеджер",value:"manager"},{title:"Работник",value:"worker"}],i=async()=>{try{if(!t.value)return;const e=await K.generateKey(t.value),l=await e.json();if(!e.ok)throw new Error(l.message||"Ошибка при генерации ключа");a.value=l.data.key}catch(e){o.value=e.message||"Ошибка при генерации ключа",s.value=!0}},d=async()=>{try{await navigator.clipboard.writeText(a.value),l.value=!0}catch(e){o.value="Не удалось скопировать ключ",s.value=!0}},c=async()=>{const e={title:"Ключ доступа",text:`Ключ доступа (${m(t.value)}): ${a.value}`,url:window.location.href};try{navigator.share?await navigator.share(e):(await navigator.clipboard.writeText(e.text),l.value=!0)}catch(n){o.value="Не удалось поделиться ключом",s.value=!0}},v=e=>{const t={manager:"orange",worker:"blue"};return t[e]||"grey"},m=e=>{const t=u.find(t=>t.value===e);return t?t.title:""};return(e,r)=>{const f=(0,n.g2)("v-card-title"),p=(0,n.g2)("v-select"),g=(0,n.g2)("v-btn"),b=(0,n.g2)("v-chip"),h=(0,n.g2)("v-divider"),_=(0,n.g2)("v-text-field"),y=(0,n.g2)("v-card-text"),F=(0,n.g2)("v-card"),w=(0,n.g2)("v-snackbar"),W=(0,n.g2)("v-col"),V=(0,n.g2)("v-row"),E=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(E,null,{default:(0,n.k6)(()=>[(0,n.bF)(V,{justify:"center"},{default:(0,n.k6)(()=>[e.isAdmin?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(W,{key:0,cols:"10",md:"5"},{default:(0,n.k6)(()=>[(0,n.bF)(F,null,{default:(0,n.k6)(()=>[(0,n.bF)(f,null,{default:(0,n.k6)(()=>[...r[5]||(r[5]=[(0,n.eW)("Сгенерировать ключ",-1)])]),_:1}),(0,n.bF)(y,null,{default:(0,n.k6)(()=>[(0,n.bF)(p,{modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=e=>t.value=e),items:u,"item-title":"title","item-value":"value",label:"Выберите роль",variant:"outlined",class:"mb-4"},null,8,["modelValue"]),(0,n.bF)(g,{color:"primary",onClick:i,disabled:!t.value,block:"",class:"mb-4"},{default:(0,n.k6)(()=>[...r[6]||(r[6]=[(0,n.eW)(" Сгенерировать ключ ",-1)])]),_:1},8,["disabled"]),a.value?((0,n.uX)(),(0,n.Wv)(F,{key:0,variant:"outlined",class:"mb-4"},{default:(0,n.k6)(()=>[(0,n.bF)(y,null,{default:(0,n.k6)(()=>[(0,n.Lk)("div",P,[(0,n.bF)(b,{color:v(t.value),class:"me-2"},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(m(t.value)),1)]),_:1},8,["color"]),r[7]||(r[7]=(0,n.Lk)("span",{class:"text-caption text-medium-emphasis"}," Роль ",-1))]),(0,n.bF)(h,{class:"my-3"}),(0,n.Lk)("div",Q,[r[8]||(r[8]=(0,n.Lk)("div",{class:"text-subtitle-2 mb-2"},"Сгенерированный ключ:",-1)),(0,n.bF)(_,{"model-value":a.value,readonly:"",variant:"outlined",density:"compact",class:"key-field"},{"append-inner":(0,n.k6)(()=>[(0,n.bF)(g,{icon:"mdi-content-copy",size:"small",variant:"text",onClick:d})]),_:1},8,["model-value"])]),(0,n.Lk)("div",M,[(0,n.bF)(g,{color:"success",variant:"outlined","prepend-icon":"mdi-content-copy",onClick:d},{default:(0,n.k6)(()=>[...r[9]||(r[9]=[(0,n.eW)(" Копировать ",-1)])]),_:1}),(0,n.bF)(g,{color:"primary",variant:"outlined","prepend-icon":"mdi-share",onClick:c},{default:(0,n.k6)(()=>[...r[10]||(r[10]=[(0,n.eW)(" Поделиться ",-1)])]),_:1})])]),_:1})]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(w,{modelValue:l.value,"onUpdate:modelValue":r[2]||(r[2]=e=>l.value=e),color:"success",timeout:"2000"},{actions:(0,n.k6)(()=>[(0,n.bF)(g,{variant:"text",onClick:r[1]||(r[1]=e=>l.value=!1)},{default:(0,n.k6)(()=>[...r[11]||(r[11]=[(0,n.eW)(" Закрыть ",-1)])]),_:1})]),default:(0,n.k6)(()=>[r[12]||(r[12]=(0,n.eW)(" Ключ скопирован в буфер обмена! ",-1))]),_:1},8,["modelValue"]),(0,n.bF)(w,{modelValue:s.value,"onUpdate:modelValue":r[4]||(r[4]=e=>s.value=e),color:"error",timeout:"3000"},{actions:(0,n.k6)(()=>[(0,n.bF)(g,{variant:"text",onClick:r[3]||(r[3]=e=>s.value=!1)},{default:(0,n.k6)(()=>[...r[13]||(r[13]=[(0,n.eW)(" Закрыть ",-1)])]),_:1})]),default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(o.value)+" ",1)]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})}}};const N=(0,u.A)(B,[["__scopeId","data-v-ca72003c"]]);var D=N,G={__name:"UserManager",setup(e){const{isAdmin:t}=R(),a=(0,r.KR)([]);async function l(){try{const e=await K.getAll(),t=await e.json();console.log(t.data.users),a.value=t.data.users}catch(e){console.error("Error fetching tasks:",e)}}return(0,n.sV)(l),(e,s)=>((0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(I,{getUsers:l,users:a.value},null,8,["users"]),(0,r.R1)(t)?((0,n.uX)(),(0,n.Wv)(D,{key:0})):(0,n.Q3)("",!0)],64))}};const H=G;var J=H;const Y={class:"text-center"};var Z={__name:"LoginPage",setup(e){const t=F(),a=(0,s.rd)(),o=(0,r.KR)(""),u=(0,r.KR)(""),i=(0,r.KR)(""),d=(0,r.KR)(!1),c=async()=>{i.value="",d.value=!0;try{await t.login({email:o.value,password:u.value}),a.push("/tasks")}catch(e){i.value=e.message}finally{d.value=!1}};return(e,t)=>{const a=(0,n.g2)("v-card-title"),r=(0,n.g2)("v-text-field"),s=(0,n.g2)("v-alert"),v=(0,n.g2)("v-btn"),m=(0,n.g2)("v-form"),f=(0,n.g2)("v-divider"),p=(0,n.g2)("v-card-text"),g=(0,n.g2)("v-card"),b=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(b,{class:"d-flex justify-center align-center fill-height"},{default:(0,n.k6)(()=>[(0,n.bF)(g,{class:"pa-6",width:"400"},{default:(0,n.k6)(()=>[(0,n.bF)(a,{class:"text-h6"},{default:(0,n.k6)(()=>[...t[3]||(t[3]=[(0,n.eW)("Login",-1)])]),_:1}),(0,n.bF)(p,null,{default:(0,n.k6)(()=>[(0,n.bF)(m,{onSubmit:(0,l.D$)(c,["prevent"]),ref:"form"},{default:(0,n.k6)(()=>[(0,n.bF)(r,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),label:"Email",type:"email","prepend-icon":"mdi-email",required:""},null,8,["modelValue"]),(0,n.bF)(r,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),label:"Password",type:"password","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"]),i.value?((0,n.uX)(),(0,n.Wv)(s,{key:0,type:"error",class:"mb-4",dense:""},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(i.value),1)]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(v,{type:"submit",color:"primary",block:"",loading:d.value},{default:(0,n.k6)(()=>[...t[4]||(t[4]=[(0,n.eW)(" Войти ",-1)])]),_:1},8,["loading"])]),_:1},512),(0,n.bF)(f,{class:"my-4"}),(0,n.Lk)("div",Y,[t[6]||(t[6]=(0,n.Lk)("span",{class:"text-body-2"},"Нет аккаунта?",-1)),(0,n.bF)(v,{variant:"text",color:"primary",onClick:t[2]||(t[2]=t=>e.$router.push("/register")),class:"ml-2"},{default:(0,n.k6)(()=>[...t[5]||(t[5]=[(0,n.eW)(" Зарегистрироваться ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})}}};const ee=Z;var te=ee;const ae={class:"text-center"};var le={__name:"RegisterPage",setup(e){const t=F(),a=(0,s.rd)(),o=(0,r.KR)(""),u=(0,r.KR)(""),i=(0,r.KR)(""),d=(0,r.KR)(""),c=(0,r.KR)(""),v=(0,r.KR)(!1),m=async()=>{c.value="",v.value=!0;try{await t.register({name:o.value,email:u.value,password:i.value,key:d.value}),a.push("/tasks")}catch(e){c.value=e.message}finally{v.value=!1}};return(e,t)=>{const a=(0,n.g2)("v-card-title"),r=(0,n.g2)("v-text-field"),s=(0,n.g2)("v-alert"),f=(0,n.g2)("v-btn"),p=(0,n.g2)("v-form"),g=(0,n.g2)("v-divider"),b=(0,n.g2)("v-card-text"),h=(0,n.g2)("v-card"),_=(0,n.g2)("v-container");return(0,n.uX)(),(0,n.Wv)(_,{class:"d-flex justify-center align-center fill-height"},{default:(0,n.k6)(()=>[(0,n.bF)(h,{class:"pa-6",width:"400"},{default:(0,n.k6)(()=>[(0,n.bF)(a,{class:"text-h6"},{default:(0,n.k6)(()=>[...t[5]||(t[5]=[(0,n.eW)("Регистрация",-1)])]),_:1}),(0,n.bF)(b,null,{default:(0,n.k6)(()=>[(0,n.bF)(p,{onSubmit:(0,l.D$)(m,["prevent"]),ref:"form"},{default:(0,n.k6)(()=>[(0,n.bF)(r,{modelValue:o.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.value=e),label:"Имя","prepend-icon":"mdi-account",required:""},null,8,["modelValue"]),(0,n.bF)(r,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=e=>u.value=e),label:"Email",type:"email","prepend-icon":"mdi-email",required:""},null,8,["modelValue"]),(0,n.bF)(r,{modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),label:"Пароль",type:"password","prepend-icon":"mdi-lock",required:""},null,8,["modelValue"]),(0,n.bF)(r,{modelValue:d.value,"onUpdate:modelValue":t[3]||(t[3]=e=>d.value=e),label:"Ключ регистрации","prepend-icon":"mdi-key",required:""},null,8,["modelValue"]),c.value?((0,n.uX)(),(0,n.Wv)(s,{key:0,type:"error",class:"mb-4",dense:""},{default:(0,n.k6)(()=>[(0,n.eW)((0,k.v_)(c.value),1)]),_:1})):(0,n.Q3)("",!0),(0,n.bF)(f,{type:"submit",color:"primary",block:"",loading:v.value},{default:(0,n.k6)(()=>[...t[6]||(t[6]=[(0,n.eW)(" Зарегистрироваться ",-1)])]),_:1},8,["loading"])]),_:1},512),(0,n.bF)(g,{class:"my-4"}),(0,n.Lk)("div",ae,[t[8]||(t[8]=(0,n.Lk)("span",{class:"text-body-2"},"Уже есть аккаунт?",-1)),(0,n.bF)(f,{variant:"text",color:"primary",onClick:t[4]||(t[4]=t=>e.$router.push("/login")),class:"ml-2"},{default:(0,n.k6)(()=>[...t[7]||(t[7]=[(0,n.eW)(" Войти ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})}}};const ne=le;var re=ne;const se=[{path:"/tasks",name:"tasks",component:L,meta:{requiresAuth:!0,roles:["admin","manager","worker"]}},{path:"/users",name:"users",component:J,meta:{requiresAuth:!0,roles:["admin","manager"]}},{path:"/",name:"dashboard",component:g,meta:{requiresAuth:!0,roles:["admin","manager","worker"]}},{path:"/login",name:"login",component:te,meta:{hideHeader:!0,requiresGuest:!0}},{path:"/register",name:"register",component:re,meta:{hideHeader:!0,requiresGuest:!0}},{path:"/forbidden",name:"forbidden",component:()=>a.e(156).then(a.bind(a,1156)),meta:{hideHeader:!0}},{path:"/:pathMatch(.*)*",redirect:"/"}],oe=(0,s.aE)({history:(0,s.LA)(),routes:se});oe.beforeEach(async(e,t,a)=>{const l=F();if(l.token&&!l.user)try{await l.fetchMe()}catch(n){console.warn("Failed to fetch user during navigation:",n.message)}if(e.meta.requiresAuth&&!l.isAuthenticated)return a("/login");if(e.meta.requiresGuest&&l.isAuthenticated)return a("/");if(e.meta.roles&&l.isAuthenticated){const t=l.role,n=e.meta.roles;if(!n.includes(t))return console.warn(`Access denied. User role: ${t}, Required roles: ${n}`),a("/forbidden")}a()});var ue=oe,ie=(a(5524),a(5753)),de=a(2801),ce=a(3425);const ve=(0,ie.$N)({components:de,directives:ce});(0,l.Ef)(m).use((0,_.Ey)()).use(ue).use(ve).mount("#app")}},t={};function a(l){var n=t[l];if(void 0!==n)return n.exports;var r=t[l]={exports:{}};return e[l].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,l,n,r){if(!l){var s=1/0;for(d=0;d<e.length;d++){l=e[d][0],n=e[d][1],r=e[d][2];for(var o=!0,u=0;u<l.length;u++)(!1&r||s>=r)&&Object.keys(a.O).every(function(e){return a.O[e](l[u])})?l.splice(u--,1):(o=!1,r<s&&(s=r));if(o){e.splice(d--,1);var i=n();void 0!==i&&(t=i)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[l,n,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var l in t)a.o(t,l)&&!a.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce(function(t,l){return a.f[l](e,t),t},[]))}}(),function(){a.u=function(e){return"js/"+e+".d16a31e0.js"}}(),function(){a.miniCssF=function(e){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="frontend:";a.l=function(l,n,r,s){if(e[l])e[l].push(n);else{var o,u;if(void 0!==r)for(var i=document.getElementsByTagName("script"),d=0;d<i.length;d++){var c=i[d];if(c.getAttribute("src")==l||c.getAttribute("data-webpack")==t+r){o=c;break}}o||(u=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",t+r),o.src=l),e[l]=[n];var v=function(t,a){o.onerror=o.onload=null,clearTimeout(m);var n=e[l];if(delete e[l],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(function(e){return e(a)}),t)return t(a)},m=setTimeout(v.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=v.bind(null,o.onerror),o.onload=v.bind(null,o.onload),u&&document.head.appendChild(o)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.p="/"}(),function(){var e={524:0};a.f.j=function(t,l){var n=a.o(e,t)?e[t]:void 0;if(0!==n)if(n)l.push(n[2]);else{var r=new Promise(function(a,l){n=e[t]=[a,l]});l.push(n[2]=r);var s=a.p+a.u(t),o=new Error,u=function(l){if(a.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var r=l&&("load"===l.type?"missing":l.type),s=l&&l.target&&l.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+s+")",o.name="ChunkLoadError",o.type=r,o.request=s,n[1](o)}};a.l(s,u,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,l){var n,r,s=l[0],o=l[1],u=l[2],i=0;if(s.some(function(t){return 0!==e[t]})){for(n in o)a.o(o,n)&&(a.m[n]=o[n]);if(u)var d=u(a)}for(t&&t(l);i<s.length;i++)r=s[i],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},l=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=a.O(void 0,[504],function(){return a(7861)});l=a.O(l)})();
//# sourceMappingURL=app.121b15bb.js.map